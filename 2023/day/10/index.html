<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-12-10">

<title>Advent of Code by Francisco Yirá - 2023: Day 10</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Advent of Code by Francisco Yirá - 2023: Day 10">
<meta property="og:description" content="My solutions to Advent of Code">
<meta property="og:site_name" content="Advent of Code by Francisco Yirá">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Advent of Code by Francisco Yirá</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../2023.html"> 
<span class="menu-text">2023</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://www.franciscoyira.com/" rel="external"> 
<span class="menu-text">blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.franciscoyira.com/subscribe"> 
<span class="menu-text">newsletter</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://cv.franciscoyira.com/"> 
<span class="menu-text">portfolio</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/franciscoyira/advent-of-code-website"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/franciscoyira/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://techhub.social/home"> <i class="bi bi-mastodon" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#part-1" id="toc-part-1" class="nav-link" data-scroll-target="#part-1">Part 1</a></li>
  <li><a href="#part-2" id="toc-part-2" class="nav-link" data-scroll-target="#part-2">Part 2</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">2023: Day 10</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 10, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p><a href="https://adventofcode.com/2023/day/10">The original challenge</a></p>
<p><a href="input" target="_blank">My data</a></p>
</section>
<section id="part-1" class="level2">
<h2 class="anchored" data-anchor-id="part-1">Part 1</h2>
<p>There are a lot of pipes and there is an animal hidden somewhere inside them. Puzzle input is a 2D sketch of all the surface pipes we can see.</p>
<ul>
<li><code>|</code> is a vertical pipe connecting north and south.</li>
<li><code>-</code> is a horizontal pipe connecting east and west.</li>
<li><code>L</code> is a 90-degree bend connecting north and east.</li>
<li><code>J</code> is a 90-degree bend connecting north and west.</li>
<li><code>7</code> is a 90-degree bend connecting south and west.</li>
<li><code>F</code> is a 90-degree bend connecting south and east.</li>
<li><code>.</code> is ground; there is no pipe in this tile.</li>
<li><code>S</code> is the starting position of the animal; there is a pipe on this tile, but your sketch doesn’t show what shape the pipe has.</li>
</ul>
<p>Prompt suggests that the animal is inside “one large, continuous loop”. For example, one like this:</p>
<pre><code>.....
.F-7.
.|.|.
.L-J.
.....</code></pre>
<p>Which would have looked like this if the animal had entered through the northwest corner:</p>
<pre><code>.....
.S-7.
.|.|.
.L-J.
.....</code></pre>
<p>Other key facts:</p>
<ul>
<li>The tile where the animal is doesn’t show its true shape, but it can be inferred from the surrounding pipes.</li>
<li>The pipe with <code>S</code> is assummed to connect back to the pipes that conect to it.</li>
<li>There are many pipes that don’t connect to the main loop.</li>
</ul>
<blockquote class="blockquote">
<p>If you want to get out ahead of the animal, you should find the tile in the loop that is farthest from the starting position. Because the animal is in the pipe, it doesn’t make sense to measure this by direct distance. Instead, you need to find the tile that would take the longest number of steps along the loop to reach from the starting point - regardless of which way around the loop the animal went.</p>
</blockquote>
<p>For example, in the following loop:</p>
<pre><code>..F7.
.FJ|.
SJ.L7
|F--J
LJ...</code></pre>
<p>Distances would look like this:</p>
<pre><code>..45.
.236.
01.78
14567
23...</code></pre>
<p>Thus, the farthest point is 8 steps away from the start.</p>
<p>The problem:</p>
<blockquote class="blockquote">
<p>Find the single giant loop starting at S. How many steps along the loop does it take to get from the starting position to the point farthest from the starting position?</p>
</blockquote>
<p>Dataframe-like data structures don’t seem right for this problem. I’ll probaby have to use 2D matrices and go through them with nested loops (kind of like the messy code I wrote for <a href="../../../2023/day/3/">day 3</a>). There might be a better data structure for approaching this, but unfortunately, I’m not aware of it yet.</p>
<p>(I have a gut feeling that this could be addressed through Object-Oriented Programming? Like, defining each of the pipes as different classes? Anyway, onto the matrices…)</p>
<p>Loading the sketch as a 2D matrix:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>sketch <span class="ot">&lt;-</span> <span class="fu">read_lines</span>(<span class="fu">here</span>(<span class="st">"2023/day/10/input"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_split</span>(<span class="at">pattern =</span> <span class="st">""</span>, <span class="at">simplify=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>sketch[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
 [1,] "F"  "-"  "7"  "J"  "F"  "-"  "F"  "-"  "F"  "|"  
 [2,] "|"  "F"  "-"  "J"  "|"  "|"  "L"  "-"  "."  "J"  
 [3,] "F"  "F"  "-"  "7"  "7"  "-"  "7"  "L"  "7"  "F"  
 [4,] "F"  "7"  "-"  "J"  "|"  "F"  "J"  "."  "-"  "-"  
 [5,] "|"  "|"  "F"  "J"  "7"  "F"  "7"  "F"  "L"  "7"  
 [6,] "F"  "7"  "7"  "."  "-"  "F"  "J"  "J"  "L"  "J"  
 [7,] "L"  "|"  "-"  "L"  "."  "J"  "|"  "."  "|"  "L"  
 [8,] "F"  "|"  "."  "|"  "."  "L"  "|"  "7"  "-"  "|"  
 [9,] "L"  "J"  "F"  "L"  "L"  "F"  "J"  "7"  "J"  "L"  
[10,] "|"  "-"  "J"  "7"  "."  "J"  "J"  "."  "7"  "7"  </code></pre>
</div>
</div>
<p>Now, how to find the “big loop”?</p>
<p>Idea: create a “twin matrix” with the same dimensions as <code>sketch</code>, intially filled with <code>NA</code>s, to represent the distances from the origin.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>all_distances <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="fu">dim</span>(sketch)[<span class="dv">1</span>],</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="fu">dim</span>(sketch)[<span class="dv">2</span>]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, look at the 8 tiles surrounding the starting tile (<code>S</code>) to start exploring the <code>sketch</code> grid.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>position_s <span class="ot">&lt;-</span> <span class="fu">which</span>(sketch <span class="sc">==</span> <span class="st">"S"</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>position_s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     row col
[1,]  76  54</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> position_s[<span class="dv">1</span>]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> position_s[<span class="dv">2</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>surroundings <span class="ot">&lt;-</span> sketch[(i<span class="dv">-1</span>)<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">1</span>), (j<span class="dv">-1</span>)<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>surroundings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,] "-"  "-"  "J" 
[2,] "-"  "S"  "-" 
[3,] "7"  "F"  "-" </code></pre>
</div>
</div>
<p>Let’s create a function that, given the <code>surroundings</code> matrix, assigns values of distance to the tiles that are connected to the central tile.</p>
<p>First, I’ll consider the particular case of the starting tile:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>distances[<span class="dv">2</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>south_connecting_pipes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"|"</span>, <span class="st">"7"</span>, <span class="st">"F"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>west_connecting_pipes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"-"</span>, <span class="st">"J"</span>, <span class="st">"7"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>east_connecting_pipes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"-"</span>, <span class="st">"L"</span>, <span class="st">"F"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>north_connecting_pipes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"|"</span>, <span class="st">"L"</span>, <span class="st">"J"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (surroundings[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">%in%</span> south_connecting_pipes) {</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  distances[<span class="dv">1</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (surroundings[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">%in%</span> east_connecting_pipes) {</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  distances[<span class="dv">2</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (surroundings[<span class="dv">3</span>,<span class="dv">2</span>] <span class="sc">%in%</span> north_connecting_pipes) {</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  distances[<span class="dv">3</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (surroundings[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">%in%</span> west_connecting_pipes) {</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  distances[<span class="dv">2</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>distances</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]   NA   NA   NA
[2,]    1    0    1
[3,]   NA   NA   NA</code></pre>
</div>
</div>
<p>I can now copy these local <code>distances</code> back to the <code>all_distances</code> twin matrix.</p>
<p>After that, I could use <code>which.max(all_distances)</code> to find the tiles that are further away from the starting tile and still connected to it.</p>
<p>Finally, I can repeat the distance assignment process, but this time starting from the tiles identified by <code>which.max</code>.</p>
<p>Copying the distance values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>all_distances[(i<span class="dv">-1</span>)<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">1</span>), (j<span class="dv">-1</span>)<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> distances</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finding the tiles that are further away from the start and still connected to it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>further_away <span class="ot">&lt;-</span> <span class="fu">which</span>(all_distances <span class="sc">==</span> <span class="fu">max</span>(all_distances, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>further_away</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     row col
[1,]  76  53
[2,]  76  55</code></pre>
</div>
</div>
<p>Let’s take the coordinates of these points, explore their surroundings, and then assign distance values to the tiles that are connected to them.</p>
<p>To simplify, I’ll first calculate the distances for just one of the <code>further_away</code> points:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>current_tile1 <span class="ot">&lt;-</span> further_away[<span class="dv">1</span>,]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> current_tile1[<span class="dv">1</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> current_tile1[<span class="dv">2</span>]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> all_distances[(i<span class="dv">-1</span>)<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">1</span>), (j<span class="dv">-1</span>)<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>surroundings <span class="ot">&lt;-</span> sketch[(i<span class="dv">-1</span>)<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">1</span>), (j<span class="dv">-1</span>)<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>surroundings</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,] "F"  "-"  "-" 
[2,] "L"  "-"  "S" 
[3,] "F"  "7"  "F" </code></pre>
</div>
</div>
<p>At this point, the rules for identifying connecting pipes should be extended to include scenarios where none of the tiles are marked with <code>S</code>. I’ll define the function <code>is_connected()</code> for this purpose.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>horizontally_connecting <span class="ot">&lt;-</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># first element = left, second element=left</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"-"</span>, <span class="st">"-"</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"-"</span>, <span class="st">"7"</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"-"</span>, <span class="st">"J"</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"L"</span>, <span class="st">"-"</span>),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"L"</span>, <span class="st">"7"</span>),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"L"</span>, <span class="st">"J"</span>),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"-"</span>),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"J"</span>),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"7"</span>),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"-"</span>),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"J"</span>),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"7"</span>),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"-"</span>, <span class="st">"S"</span>),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"L"</span>, <span class="st">"S"</span>),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"S"</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>vertically_connecting <span class="ot">&lt;-</span> </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a> <span class="co"># first element = top, second element = bottom</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"|"</span>, <span class="st">"|"</span>),</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"|"</span>),</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"7"</span>, <span class="st">"|"</span>),</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"|"</span>, <span class="st">"J"</span>),</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"J"</span>),</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"7"</span>, <span class="st">"J"</span>),</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"L"</span>),</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"7"</span>, <span class="st">"L"</span>),</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"|"</span>, <span class="st">"L"</span>),</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"|"</span>),</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"L"</span>),</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"J"</span>),</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"|"</span>, <span class="st">"S"</span>),</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"7"</span>, <span class="st">"S"</span>),</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"S"</span>)</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>is_connected <span class="ot">&lt;-</span> <span class="cf">function</span>(pair_tiles, direction) {</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the logic for identifying connecting pipes depends on the direction we're moving to</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (direction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"S"</span>)) {</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span> (<span class="fu">list</span>(pair_tiles) <span class="sc">%in%</span> vertically_connecting)</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span> (<span class="fu">list</span>(pair_tiles) <span class="sc">%in%</span> horizontally_connecting)</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using a named list to give friendly names to directions in the 3x3 matrices:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>directions <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>),</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"N"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"E"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"W"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s use this function to calculate the distances surrounding our current location (<code>current_tile1</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>central_tile <span class="ot">&lt;-</span> surroundings[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_dir <span class="cf">in</span> <span class="fu">seq_along</span>(directions)) {</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  direction <span class="ot">&lt;-</span> <span class="fu">names</span>(directions)[i_dir]</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  surr_i <span class="ot">&lt;-</span> directions[[i_dir]][<span class="dv">1</span>]</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  surr_j <span class="ot">&lt;-</span> directions[[i_dir]][<span class="dv">2</span>]</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  cur_surr_tile <span class="ot">&lt;-</span> surroundings[surr_i, surr_j]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(distances[surr_i, surr_j])) {</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># NA in distance means a comparation hasn't been done</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (direction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"E"</span>)) tile_pair <span class="ot">&lt;-</span> <span class="fu">c</span>(central_tile, cur_surr_tile)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (direction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"W"</span>)) tile_pair <span class="ot">&lt;-</span> <span class="fu">c</span>(cur_surr_tile, central_tile)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    connected <span class="ot">&lt;-</span> <span class="fu">is_connected</span>(tile_pair, direction)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connected) {</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>      distances[surr_i, surr_j] <span class="ot">&lt;-</span> distances[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>all_distances[(i<span class="dv">-1</span>)<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">1</span>), (j<span class="dv">-1</span>)<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> distances</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So far, the code is working as expected.</p>
<p>Now it’s time to organise the code into functions. I need to start with a function that does the following:</p>
<ul>
<li>Receives <code>sketch</code>, <code>all_distances</code> and a set of coordinates (the output of <code>which.max</code>) as inputs.</li>
<li>Explores the surroundings of those coordinates.</li>
<li>Applies the previously described logic to calculate distance values for tiles connected to those coordinates.</li>
<li>Return an updated version of the <code>all_distances</code> with the values from the previous step.</li>
</ul>
<p>The set of coordinates will be assummed to be a matrix, as per the output of <code>which(all_distances == max(all_distances, na.rm = TRUE), arr.ind = TRUE)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>explore_surroundings <span class="ot">&lt;-</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    coordinates,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">this_sketch =</span> sketch,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">these_distances =</span> all_distances) {</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i_coord <span class="cf">in</span> <span class="fu">seq_along</span>(coordinates[,<span class="st">"row"</span>])) {</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        i <span class="ot">&lt;-</span> coordinates[i_coord, <span class="st">"row"</span>]</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>        j <span class="ot">&lt;-</span> coordinates[i_coord, <span class="st">"col"</span>]</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        surroundings <span class="ot">&lt;-</span> this_sketch[(i <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span>(i <span class="sc">+</span> <span class="dv">1</span>), (j <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span>(j <span class="sc">+</span> <span class="dv">1</span>)]</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        distances <span class="ot">&lt;-</span> these_distances[(i <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span>(i <span class="sc">+</span> <span class="dv">1</span>), (j <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span>(j <span class="sc">+</span> <span class="dv">1</span>)]</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>        central_tile <span class="ot">&lt;-</span> surroundings[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i_dir <span class="cf">in</span> <span class="fu">seq_along</span>(directions)) {</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>          direction <span class="ot">&lt;-</span> <span class="fu">names</span>(directions)[i_dir]</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>          surr_i <span class="ot">&lt;-</span> directions[[i_dir]][<span class="dv">1</span>]</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>          surr_j <span class="ot">&lt;-</span> directions[[i_dir]][<span class="dv">2</span>]</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>          cur_surr_tile <span class="ot">&lt;-</span> surroundings[surr_i, surr_j]</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="fu">is.na</span>(distances[surr_i, surr_j])) {</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>            <span class="co"># NA in distance means a comparation hasn't been done</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (direction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"E"</span>)) tile_pair <span class="ot">&lt;-</span> <span class="fu">c</span>(central_tile, cur_surr_tile)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (direction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"W"</span>)) tile_pair <span class="ot">&lt;-</span> <span class="fu">c</span>(cur_surr_tile, central_tile)</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>            connected <span class="ot">&lt;-</span> <span class="fu">is_connected</span>(tile_pair, direction)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (connected) {</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>              distances[surr_i, surr_j] <span class="ot">&lt;-</span> distances[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>        these_distances[(i <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span>(i <span class="sc">+</span> <span class="dv">1</span>), (j <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span>(j <span class="sc">+</span> <span class="dv">1</span>)] <span class="ot">&lt;-</span> distances</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(these_distances)</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, I should be able to navigate through the pipes by repeatedly executing the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example code: not meant to run</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>all_distances <span class="ot">&lt;-</span> <span class="fu">explore_surroundings</span>(further_away)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>further_away <span class="ot">&lt;-</span> <span class="fu">which</span>(all_distances <span class="sc">==</span> <span class="fu">max</span>(all_distances, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I’m considering a <code>while</code> loop for this, but I’m not quite sure what the stopping condition should be. Maybe it could stop when it’s about to overwrite a cell that already has a distance value. That would mean we’re going back to a cell we’ve already visited, suggesting the loop has come full circle.</p>
<p>Let’s try doing that. First, we declare the starting conditions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>further_away <span class="ot">&lt;-</span> <span class="fu">which</span>(sketch <span class="sc">==</span> <span class="st">"S"</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>all_distances <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="fu">dim</span>(sketch)[<span class="dv">1</span>],</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="fu">dim</span>(sketch)[<span class="dv">2</span>]</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>all_distances[further_away[<span class="dv">1</span>, <span class="st">"row"</span>], further_away[<span class="dv">1</span>, <span class="st">"col"</span>]] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now onto the loop itself:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  new_distances <span class="ot">&lt;-</span> <span class="fu">explore_surroundings</span>(further_away)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Stopping condition</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(new_distances <span class="sc">&gt;</span> all_distances, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Another stopping condition: the amount of NAs is the same (no exploration)</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(new_distances)) <span class="sc">==</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(all_distances))) <span class="cf">break</span> </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  all_distances <span class="ot">&lt;-</span> new_distances</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  further_away <span class="ot">&lt;-</span> <span class="fu">which</span>(all_distances <span class="sc">==</span> <span class="fu">max</span>(all_distances, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once the code stops, I just need to find the highest value in the <code>all_distances</code> matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(all_distances, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6682</code></pre>
</div>
</div>
<p>It’s correct! (I almost can’t believe it, given how messy my code is 😅).</p>
</section>
<section id="part-2" class="level2">
<h2 class="anchored" data-anchor-id="part-2">Part 2</h2>
<p>Now we have to calculate how many tiles are contained <em>within</em> the loop. The definition of being within the loop is quite specific. For example, in the sketch below, the tiles marked with <code>0</code> are technically <em>outside the loop</em>.</p>
<pre><code>..........
.S------7.
.|F----7|.
.||OOOO||.
.||OOOO||.
.|L-7F-J|.
.|II||II|.
.L--JL--J.
..........</code></pre>
<blockquote class="blockquote">
<p>Any tile that isn’t part of the main loop can count as being enclosed by the loop.</p>
</blockquote>
<p>The task is to find how many tiles are enclosed by the loop.</p>
<p>Before trying to solve this, I want to visualize the values in the <code>all_distances</code> matrix. This will help me get a better idea of the loop’s size and shape.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plot.matrix)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="dv">6000</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">svg</span>(<span class="st">"all_distances.svg"</span>, <span class="at">height=</span><span class="dv">80</span>, <span class="at">width=</span><span class="dv">80</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Code of the plot</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> <span class="fu">plot</span>(</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  all_distances,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks=</span>brk,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.col=</span><span class="st">"grey"</span>,</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.cell=</span><span class="cn">FALSE</span>,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">magma</span>(brk), </span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits=</span><span class="dv">1</span>,</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.cell=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.5</span>),</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt.cell=</span><span class="st">"%.0f"</span>,</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">key=</span><span class="cn">NULL</span>,</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">polygon.key=</span><span class="cn">NULL</span>,</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.col=</span><span class="cn">NULL</span>,</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.row=</span><span class="cn">NULL</span>,</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="cn">NA</span>, <span class="at">ylab=</span><span class="cn">NA</span>)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Close the graphics device</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The output of the code above is a giant SVG image that depicts the full <code>all_distances</code> matrix, highlighting the tiles that are part of the loop (they’re colour-coded based on their distance to the starting tile and they also display the distance value as text on top of them).</p>
<p>The plot with the text is too big to show it on this page (here is the <a href="all_distances.svg">full-size version of the plot</a>), so I’ll display just a section of it below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> position_s[<span class="dv">1</span>]</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> position_s[<span class="dv">2</span>]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  all_distances[(i<span class="dv">-10</span>)<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">10</span>), (j<span class="dv">-10</span>)<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">10</span>)],</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Tiles in the loop (and their distances to origin)"</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks=</span>brk,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.col=</span><span class="st">"grey"</span>,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.cell=</span><span class="cn">FALSE</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">magma</span>(brk), </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits=</span><span class="dv">1</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.cell=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.5</span>),</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt.cell=</span><span class="st">"%.0f"</span>,</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">key=</span><span class="cn">NULL</span>,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">polygon.key=</span><span class="cn">NULL</span>,</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.col=</span><span class="cn">NULL</span>,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.row=</span><span class="cn">NULL</span>,</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="cn">NA</span>, <span class="at">ylab=</span><span class="cn">NA</span>,</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">asp=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>And here is a “miniature version” without the text (darker colours represent tiles closer to the origin and white represents tiles that are not part of the loop).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  all_distances,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="cn">NULL</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks=</span>brk,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.col=</span><span class="st">"grey"</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.cell=</span><span class="cn">FALSE</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">magma</span>(brk), </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">key=</span><span class="cn">NULL</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">polygon.key=</span><span class="cn">NULL</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.col=</span><span class="cn">NULL</span>,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.row=</span><span class="cn">NULL</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="cn">NA</span>, <span class="at">ylab=</span><span class="cn">NA</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">asp=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Based on the plot, we can see that the loop is really big and has a complex shape, including many twists and turns.</p>
<p>I’m also curious about how many ‘arms’ or paths branch off from the loop. Are there any that lead to dead-ends and don’t reconnect with the main loop? (In that case, there would be distance values I would have to discard before identifying the tiles enclosed by the loop).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>distances_values <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">max</span>(all_distances, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>n_tiles_distance <span class="ot">&lt;-</span> <span class="cf">function</span>(distance) {</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(all_distances <span class="sc">==</span> distance, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">distances =</span> distances_values,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_paths =</span> <span class="fu">map_dbl</span>(distances, n_tiles_distance)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(n_paths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  n_paths     n
    &lt;dbl&gt; &lt;int&gt;
1       1     1
2       2  6681</code></pre>
</div>
</div>
<p>There are always only two paths branching off the starting tile, ensuring there are no ‘dead-ends’ in the loop.</p>
<p>Next steps:</p>
<ul>
<li>Traverse the loop in a counter-clockwise direction, inspecting the tiles to the left of the path. Consider tiles with <code>NA</code> as distance value as “enclosed” by the loop.</li>
<li>After identifying these inner loop cells (and verifying via visual inspection that they actually are within the loop), initiate a ‘contagion’ process. This means marking contiguous non-loop tiles as “enclosed by the loop”.</li>
</ul>
<p>Implementing my idea for the “base case” (the starting tile <code>S</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>starting_position <span class="ot">&lt;-</span> <span class="fu">which</span>(all_distances <span class="sc">==</span> <span class="dv">0</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> starting_position[<span class="dv">1</span>, <span class="st">"row"</span>]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> starting_position[<span class="dv">1</span>, <span class="st">"col"</span>]</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>directions <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"N"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"W"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"E"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The coordinates for ‘the cell to the left’ and ‘the cell to the right’ will vary depending on the direction. E.g. if we go South from the centre tile (2,2 to 3,2), the coordinates of the “cell to the right” are going to be 3,1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>to_the_right <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"N"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"E"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"W"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>to_the_left <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"N"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"E"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"W"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I’ll use the value -1 in the distances matrix to mark the tiles that are enclosed by the loop.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>new_i <span class="ot">&lt;-</span> i</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>new_j <span class="ot">&lt;-</span> j</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  distances <span class="ot">&lt;-</span> all_distances[(new_i<span class="dv">-1</span>)<span class="sc">:</span>(new_i<span class="sc">+</span><span class="dv">1</span>), (new_j<span class="dv">-1</span>)<span class="sc">:</span>(new_j<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># I'll use the `directions` vector which was declared before to check the cardinal coordinates</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Given the order of the list `directions`, this loop will go East first</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_dir <span class="cf">in</span> <span class="fu">seq_along</span>(directions)) {</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    direction <span class="ot">&lt;-</span> <span class="fu">names</span>(directions)[i_dir]</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    surr_i <span class="ot">&lt;-</span> directions[[i_dir]][<span class="dv">1</span>]</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    surr_j <span class="ot">&lt;-</span> directions[[i_dir]][<span class="dv">2</span>]</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    surr_dist_val <span class="ot">&lt;-</span> <span class="fu">replace_na</span>(distances[surr_i, surr_j], <span class="dv">0</span>)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Go in the direction of the cell that increments distance by 1</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (surr_dist_val <span class="sc">-</span> distances[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>      <span class="co">#  mark the tile to the left as "inside"</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>      i_left <span class="ot">&lt;-</span> to_the_left[[direction]][<span class="dv">1</span>]</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>      j_left <span class="ot">&lt;-</span> to_the_left[[direction]][<span class="dv">1</span>]</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">is.na</span>(distances[i_left, j_left])) {</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>        distances[i_left, j_left] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Updating i and j to reflect that we moved</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>      new_i <span class="ot">&lt;-</span> i <span class="sc">+</span> surr_i <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>      new_j <span class="ot">&lt;-</span> j <span class="sc">+</span> surr_j <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stopping condition: </span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (distances[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">==</span> all_distances[new_i, new_j]) <span class="cf">break</span></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>  all_distances[(i<span class="dv">-1</span>)<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">1</span>), (j<span class="dv">-1</span>)<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> distances</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> new_i</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> new_j</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Counting the tiles that have been marked as inside the loop until now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(all_distances <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 390</code></pre>
</div>
</div>
<p>Visual inspection:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  all_distances,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">'Tiles inside the loop (before the contagion process)'</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sub=</span><span class="st">"White = NA / Grey = Part of the loop / Black = enclosed by the loop"</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.col=</span><span class="st">"grey"</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.cell=</span><span class="cn">FALSE</span>,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">magma</span>(<span class="dv">4</span>), </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">key=</span><span class="cn">NULL</span>,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">polygon.key=</span><span class="cn">NULL</span>,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.col=</span><span class="cn">NULL</span>,</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.row=</span><span class="cn">NULL</span>,</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="cn">NA</span>, <span class="at">ylab=</span><span class="cn">NA</span>,</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">asp=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>After looking carefully at <a href="all_distances_part2.svg">the full-size visualisation</a>, it seems there are two issues:</p>
<ol type="1">
<li>I’m not correctly handling the case then the loop takes a turn.</li>
<li>Only one of the loop’s ‘arms’ is being traversed, but there are two.</li>
</ol>
<p>Unfortunately, the time I’ve spent on this problem has exceeded my “time budget” and I’m not even sure that the algorithm I’m implementing will lead to the correct solution, so I’m deciding to stop here.</p>
<p><img src="Thats_all_folks.png" title="That's all folks!" class="img-fluid"></p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/franciscoyira\.github\.io\/advent-of-code-website\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb41" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "2023: Day 10"</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2023-12-10</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co">  - R</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> true</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="fu">## Setup</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">The original challenge</span><span class="co">](https://adventofcode.com/2023/day/10)</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">My data</span><span class="co">](input)</span>{target="_blank"}</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>There are a lot of pipes and there is an animal hidden somewhere inside them. Puzzle input is a 2D sketch of all the surface pipes we can see.</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`|`</span> is a vertical pipe connecting north and south.</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`-`</span> is a horizontal pipe connecting east and west.</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`L`</span> is a 90-degree bend connecting north and east.</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`J`</span> is a 90-degree bend connecting north and west.</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`7`</span> is a 90-degree bend connecting south and west.</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`F`</span> is a 90-degree bend connecting south and east.</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`.`</span> is ground; there is no pipe in this tile.</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`S`</span> is the starting position of the animal; there is a pipe on this tile, but your sketch doesn't show what shape the pipe has.</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>Prompt suggests that the animal is inside "one large, continuous loop". For example, one like this:</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="in">.....</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a><span class="in">.F-7.</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="in">.|.|.</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a><span class="in">.L-J.</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a><span class="in">.....</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>Which would have looked like this if the animal had entered through the northwest corner:</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a><span class="in">.....</span></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a><span class="in">.S-7.</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a><span class="in">.|.|.</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a><span class="in">.L-J.</span></span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a><span class="in">.....</span></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>Other key facts:</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The tile where the animal is doesn't show its true shape, but it can be inferred from the surrounding pipes.</span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The pipe with <span class="in">`S`</span> is assummed to connect back to the pipes that conect to it.</span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>There are many pipes that don't connect to the main loop.</span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; If you want to get out ahead of the animal, you should find the tile in the loop that is farthest from the starting position. Because the animal is in the pipe, it doesn't make sense to measure this by direct distance. Instead, you need to find the tile that would take the longest number of steps along the loop to reach from the starting point - regardless of which way around the loop the animal went.</span></span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>For example, in the following loop:</span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a><span class="in">..F7.</span></span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a><span class="in">.FJ|.</span></span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a><span class="in">SJ.L7</span></span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a><span class="in">|F--J</span></span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a><span class="in">LJ...</span></span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a>Distances would look like this:</span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a><span class="in">..45.</span></span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a><span class="in">.236.</span></span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a><span class="in">01.78</span></span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a><span class="in">14567</span></span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a><span class="in">23...</span></span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a>Thus, the farthest point is 8 steps away from the start.</span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a>The problem:</span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Find the single giant loop starting at S. How many steps along the loop does it take to get from the starting position to the point farthest from the starting position?</span></span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a>Dataframe-like data structures don't seem right for this problem. I'll probaby have to use 2D matrices and go through them with nested loops (kind of like the messy code I wrote for <span class="co">[</span><span class="ot">day 3</span><span class="co">](/2023/day/3/)</span>). There might be a better data structure for approaching this, but unfortunately, I'm not aware of it yet.</span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a>(I have a gut feeling that this could be addressed through Object-Oriented Programming? Like, defining each of the pipes as different classes? Anyway, onto the matrices...)</span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a>Loading the sketch as a 2D matrix:</span>
<span id="cb41-85"><a href="#cb41-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-86"><a href="#cb41-86" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb41-87"><a href="#cb41-87" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb41-88"><a href="#cb41-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-89"><a href="#cb41-89" aria-hidden="true" tabindex="-1"></a>sketch <span class="ot">&lt;-</span> <span class="fu">read_lines</span>(<span class="fu">here</span>(<span class="st">"2023/day/10/input"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-90"><a href="#cb41-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_split</span>(<span class="at">pattern =</span> <span class="st">""</span>, <span class="at">simplify=</span><span class="cn">TRUE</span>)</span>
<span id="cb41-91"><a href="#cb41-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-92"><a href="#cb41-92" aria-hidden="true" tabindex="-1"></a>sketch[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb41-93"><a href="#cb41-93" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-94"><a href="#cb41-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-95"><a href="#cb41-95" aria-hidden="true" tabindex="-1"></a>Now, how to find the "big loop"?</span>
<span id="cb41-96"><a href="#cb41-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-97"><a href="#cb41-97" aria-hidden="true" tabindex="-1"></a>Idea: create a "twin matrix" with the same dimensions as <span class="in">`sketch`</span>, intially filled with <span class="in">`NA`</span>s, to represent the distances from the origin.</span>
<span id="cb41-98"><a href="#cb41-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-101"><a href="#cb41-101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-102"><a href="#cb41-102" aria-hidden="true" tabindex="-1"></a>all_distances <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb41-103"><a href="#cb41-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="fu">dim</span>(sketch)[<span class="dv">1</span>],</span>
<span id="cb41-104"><a href="#cb41-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="fu">dim</span>(sketch)[<span class="dv">2</span>]</span>
<span id="cb41-105"><a href="#cb41-105" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-106"><a href="#cb41-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-107"><a href="#cb41-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-108"><a href="#cb41-108" aria-hidden="true" tabindex="-1"></a>Then, look at the 8 tiles surrounding the starting tile (<span class="in">`S`</span>) to start exploring the <span class="in">`sketch`</span> grid.</span>
<span id="cb41-111"><a href="#cb41-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-112"><a href="#cb41-112" aria-hidden="true" tabindex="-1"></a>position_s <span class="ot">&lt;-</span> <span class="fu">which</span>(sketch <span class="sc">==</span> <span class="st">"S"</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-113"><a href="#cb41-113" aria-hidden="true" tabindex="-1"></a>position_s</span>
<span id="cb41-114"><a href="#cb41-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-115"><a href="#cb41-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-118"><a href="#cb41-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-119"><a href="#cb41-119" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> position_s[<span class="dv">1</span>]</span>
<span id="cb41-120"><a href="#cb41-120" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> position_s[<span class="dv">2</span>]</span>
<span id="cb41-121"><a href="#cb41-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-122"><a href="#cb41-122" aria-hidden="true" tabindex="-1"></a>surroundings <span class="ot">&lt;-</span> sketch[(i<span class="dv">-1</span>)<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">1</span>), (j<span class="dv">-1</span>)<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb41-123"><a href="#cb41-123" aria-hidden="true" tabindex="-1"></a>surroundings</span>
<span id="cb41-124"><a href="#cb41-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-125"><a href="#cb41-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-126"><a href="#cb41-126" aria-hidden="true" tabindex="-1"></a>Let's create a function that, given the <span class="in">`surroundings`</span> matrix, assigns values of distance to the tiles that are connected to the central tile.</span>
<span id="cb41-127"><a href="#cb41-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-128"><a href="#cb41-128" aria-hidden="true" tabindex="-1"></a>First, I'll consider the particular case of the starting tile:</span>
<span id="cb41-131"><a href="#cb41-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-132"><a href="#cb41-132" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb41-133"><a href="#cb41-133" aria-hidden="true" tabindex="-1"></a>distances[<span class="dv">2</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb41-134"><a href="#cb41-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-135"><a href="#cb41-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-138"><a href="#cb41-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-139"><a href="#cb41-139" aria-hidden="true" tabindex="-1"></a>south_connecting_pipes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"|"</span>, <span class="st">"7"</span>, <span class="st">"F"</span>)</span>
<span id="cb41-140"><a href="#cb41-140" aria-hidden="true" tabindex="-1"></a>west_connecting_pipes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"-"</span>, <span class="st">"J"</span>, <span class="st">"7"</span>)</span>
<span id="cb41-141"><a href="#cb41-141" aria-hidden="true" tabindex="-1"></a>east_connecting_pipes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"-"</span>, <span class="st">"L"</span>, <span class="st">"F"</span>)</span>
<span id="cb41-142"><a href="#cb41-142" aria-hidden="true" tabindex="-1"></a>north_connecting_pipes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"|"</span>, <span class="st">"L"</span>, <span class="st">"J"</span>)</span>
<span id="cb41-143"><a href="#cb41-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-144"><a href="#cb41-144" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (surroundings[<span class="dv">1</span>, <span class="dv">2</span>] <span class="sc">%in%</span> south_connecting_pipes) {</span>
<span id="cb41-145"><a href="#cb41-145" aria-hidden="true" tabindex="-1"></a>  distances[<span class="dv">1</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb41-146"><a href="#cb41-146" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-147"><a href="#cb41-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-148"><a href="#cb41-148" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (surroundings[<span class="dv">2</span>, <span class="dv">1</span>] <span class="sc">%in%</span> east_connecting_pipes) {</span>
<span id="cb41-149"><a href="#cb41-149" aria-hidden="true" tabindex="-1"></a>  distances[<span class="dv">2</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb41-150"><a href="#cb41-150" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-151"><a href="#cb41-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-152"><a href="#cb41-152" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (surroundings[<span class="dv">3</span>,<span class="dv">2</span>] <span class="sc">%in%</span> north_connecting_pipes) {</span>
<span id="cb41-153"><a href="#cb41-153" aria-hidden="true" tabindex="-1"></a>  distances[<span class="dv">3</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb41-154"><a href="#cb41-154" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-155"><a href="#cb41-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-156"><a href="#cb41-156" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (surroundings[<span class="dv">2</span>, <span class="dv">3</span>] <span class="sc">%in%</span> west_connecting_pipes) {</span>
<span id="cb41-157"><a href="#cb41-157" aria-hidden="true" tabindex="-1"></a>  distances[<span class="dv">2</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb41-158"><a href="#cb41-158" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-159"><a href="#cb41-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-160"><a href="#cb41-160" aria-hidden="true" tabindex="-1"></a>distances</span>
<span id="cb41-161"><a href="#cb41-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-162"><a href="#cb41-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-163"><a href="#cb41-163" aria-hidden="true" tabindex="-1"></a>I can now copy these local <span class="in">`distances`</span> back to the <span class="in">`all_distances`</span> twin matrix.</span>
<span id="cb41-164"><a href="#cb41-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-165"><a href="#cb41-165" aria-hidden="true" tabindex="-1"></a>After that, I could use <span class="in">`which.max(all_distances)`</span> to find the tiles that are further away from the starting tile and still connected to it.</span>
<span id="cb41-166"><a href="#cb41-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-167"><a href="#cb41-167" aria-hidden="true" tabindex="-1"></a>Finally, I can repeat the distance assignment process, but this time starting from the tiles identified by <span class="in">`which.max`</span>.</span>
<span id="cb41-168"><a href="#cb41-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-169"><a href="#cb41-169" aria-hidden="true" tabindex="-1"></a>Copying the distance values:</span>
<span id="cb41-172"><a href="#cb41-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-173"><a href="#cb41-173" aria-hidden="true" tabindex="-1"></a>all_distances[(i<span class="dv">-1</span>)<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">1</span>), (j<span class="dv">-1</span>)<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> distances</span>
<span id="cb41-174"><a href="#cb41-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-175"><a href="#cb41-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-176"><a href="#cb41-176" aria-hidden="true" tabindex="-1"></a>Finding the tiles that are further away from the start and still connected to it:</span>
<span id="cb41-179"><a href="#cb41-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-180"><a href="#cb41-180" aria-hidden="true" tabindex="-1"></a>further_away <span class="ot">&lt;-</span> <span class="fu">which</span>(all_distances <span class="sc">==</span> <span class="fu">max</span>(all_distances, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-181"><a href="#cb41-181" aria-hidden="true" tabindex="-1"></a>further_away</span>
<span id="cb41-182"><a href="#cb41-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-183"><a href="#cb41-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-184"><a href="#cb41-184" aria-hidden="true" tabindex="-1"></a>Let's take the coordinates of these points, explore their surroundings, and then assign distance values to the tiles that are connected to them.</span>
<span id="cb41-185"><a href="#cb41-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-186"><a href="#cb41-186" aria-hidden="true" tabindex="-1"></a>To simplify, I'll first calculate the distances for just one of the <span class="in">`further_away`</span> points:</span>
<span id="cb41-189"><a href="#cb41-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-190"><a href="#cb41-190" aria-hidden="true" tabindex="-1"></a>current_tile1 <span class="ot">&lt;-</span> further_away[<span class="dv">1</span>,]</span>
<span id="cb41-191"><a href="#cb41-191" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> current_tile1[<span class="dv">1</span>]</span>
<span id="cb41-192"><a href="#cb41-192" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> current_tile1[<span class="dv">2</span>]</span>
<span id="cb41-193"><a href="#cb41-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-194"><a href="#cb41-194" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> all_distances[(i<span class="dv">-1</span>)<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">1</span>), (j<span class="dv">-1</span>)<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb41-195"><a href="#cb41-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-196"><a href="#cb41-196" aria-hidden="true" tabindex="-1"></a>surroundings <span class="ot">&lt;-</span> sketch[(i<span class="dv">-1</span>)<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">1</span>), (j<span class="dv">-1</span>)<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb41-197"><a href="#cb41-197" aria-hidden="true" tabindex="-1"></a>surroundings</span>
<span id="cb41-198"><a href="#cb41-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-199"><a href="#cb41-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-200"><a href="#cb41-200" aria-hidden="true" tabindex="-1"></a>At this point, the rules for identifying connecting pipes should be extended to include scenarios where none of the tiles are marked with <span class="in">`S`</span>. I'll define the function <span class="in">`is_connected()`</span> for this purpose.</span>
<span id="cb41-201"><a href="#cb41-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-202"><a href="#cb41-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r is_connected}</span></span>
<span id="cb41-203"><a href="#cb41-203" aria-hidden="true" tabindex="-1"></a><span class="in">horizontally_connecting &lt;- </span></span>
<span id="cb41-204"><a href="#cb41-204" aria-hidden="true" tabindex="-1"></a><span class="in"> # first element = left, second element=left</span></span>
<span id="cb41-205"><a href="#cb41-205" aria-hidden="true" tabindex="-1"></a><span class="in">  list(</span></span>
<span id="cb41-206"><a href="#cb41-206" aria-hidden="true" tabindex="-1"></a><span class="in">    c("-", "-"),</span></span>
<span id="cb41-207"><a href="#cb41-207" aria-hidden="true" tabindex="-1"></a><span class="in">    c("-", "7"),</span></span>
<span id="cb41-208"><a href="#cb41-208" aria-hidden="true" tabindex="-1"></a><span class="in">    c("-", "J"),</span></span>
<span id="cb41-209"><a href="#cb41-209" aria-hidden="true" tabindex="-1"></a><span class="in">    c("L", "-"),</span></span>
<span id="cb41-210"><a href="#cb41-210" aria-hidden="true" tabindex="-1"></a><span class="in">    c("L", "7"),</span></span>
<span id="cb41-211"><a href="#cb41-211" aria-hidden="true" tabindex="-1"></a><span class="in">    c("L", "J"),</span></span>
<span id="cb41-212"><a href="#cb41-212" aria-hidden="true" tabindex="-1"></a><span class="in">    c("F", "-"),</span></span>
<span id="cb41-213"><a href="#cb41-213" aria-hidden="true" tabindex="-1"></a><span class="in">    c("F", "J"),</span></span>
<span id="cb41-214"><a href="#cb41-214" aria-hidden="true" tabindex="-1"></a><span class="in">    c("F", "7"),</span></span>
<span id="cb41-215"><a href="#cb41-215" aria-hidden="true" tabindex="-1"></a><span class="in">    c("S", "-"),</span></span>
<span id="cb41-216"><a href="#cb41-216" aria-hidden="true" tabindex="-1"></a><span class="in">    c("S", "J"),</span></span>
<span id="cb41-217"><a href="#cb41-217" aria-hidden="true" tabindex="-1"></a><span class="in">    c("S", "7"),</span></span>
<span id="cb41-218"><a href="#cb41-218" aria-hidden="true" tabindex="-1"></a><span class="in">    c("-", "S"),</span></span>
<span id="cb41-219"><a href="#cb41-219" aria-hidden="true" tabindex="-1"></a><span class="in">    c("L", "S"),</span></span>
<span id="cb41-220"><a href="#cb41-220" aria-hidden="true" tabindex="-1"></a><span class="in">    c("F", "S")</span></span>
<span id="cb41-221"><a href="#cb41-221" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb41-222"><a href="#cb41-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-223"><a href="#cb41-223" aria-hidden="true" tabindex="-1"></a><span class="in">vertically_connecting &lt;- </span></span>
<span id="cb41-224"><a href="#cb41-224" aria-hidden="true" tabindex="-1"></a><span class="in"> # first element = top, second element = bottom</span></span>
<span id="cb41-225"><a href="#cb41-225" aria-hidden="true" tabindex="-1"></a><span class="in">  list(</span></span>
<span id="cb41-226"><a href="#cb41-226" aria-hidden="true" tabindex="-1"></a><span class="in">    c("|", "|"),</span></span>
<span id="cb41-227"><a href="#cb41-227" aria-hidden="true" tabindex="-1"></a><span class="in">    c("F", "|"),</span></span>
<span id="cb41-228"><a href="#cb41-228" aria-hidden="true" tabindex="-1"></a><span class="in">    c("7", "|"),</span></span>
<span id="cb41-229"><a href="#cb41-229" aria-hidden="true" tabindex="-1"></a><span class="in">    c("|", "J"),</span></span>
<span id="cb41-230"><a href="#cb41-230" aria-hidden="true" tabindex="-1"></a><span class="in">    c("F", "J"),</span></span>
<span id="cb41-231"><a href="#cb41-231" aria-hidden="true" tabindex="-1"></a><span class="in">    c("7", "J"),</span></span>
<span id="cb41-232"><a href="#cb41-232" aria-hidden="true" tabindex="-1"></a><span class="in">    c("F", "L"),</span></span>
<span id="cb41-233"><a href="#cb41-233" aria-hidden="true" tabindex="-1"></a><span class="in">    c("7", "L"),</span></span>
<span id="cb41-234"><a href="#cb41-234" aria-hidden="true" tabindex="-1"></a><span class="in">    c("|", "L"),</span></span>
<span id="cb41-235"><a href="#cb41-235" aria-hidden="true" tabindex="-1"></a><span class="in">    c("S", "|"),</span></span>
<span id="cb41-236"><a href="#cb41-236" aria-hidden="true" tabindex="-1"></a><span class="in">    c("S", "L"),</span></span>
<span id="cb41-237"><a href="#cb41-237" aria-hidden="true" tabindex="-1"></a><span class="in">    c("S", "J"),</span></span>
<span id="cb41-238"><a href="#cb41-238" aria-hidden="true" tabindex="-1"></a><span class="in">    c("|", "S"),</span></span>
<span id="cb41-239"><a href="#cb41-239" aria-hidden="true" tabindex="-1"></a><span class="in">    c("7", "S"),</span></span>
<span id="cb41-240"><a href="#cb41-240" aria-hidden="true" tabindex="-1"></a><span class="in">    c("F", "S")</span></span>
<span id="cb41-241"><a href="#cb41-241" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb41-242"><a href="#cb41-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-243"><a href="#cb41-243" aria-hidden="true" tabindex="-1"></a><span class="in">is_connected &lt;- function(pair_tiles, direction) {</span></span>
<span id="cb41-244"><a href="#cb41-244" aria-hidden="true" tabindex="-1"></a><span class="in">  # the logic for identifying connecting pipes depends on the direction we're moving to</span></span>
<span id="cb41-245"><a href="#cb41-245" aria-hidden="true" tabindex="-1"></a><span class="in">  if (direction %in% c("N", "S")) {</span></span>
<span id="cb41-246"><a href="#cb41-246" aria-hidden="true" tabindex="-1"></a><span class="in">    return (list(pair_tiles) %in% vertically_connecting)</span></span>
<span id="cb41-247"><a href="#cb41-247" aria-hidden="true" tabindex="-1"></a><span class="in">  } else {</span></span>
<span id="cb41-248"><a href="#cb41-248" aria-hidden="true" tabindex="-1"></a><span class="in">    return (list(pair_tiles) %in% horizontally_connecting)</span></span>
<span id="cb41-249"><a href="#cb41-249" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb41-250"><a href="#cb41-250" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb41-251"><a href="#cb41-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-252"><a href="#cb41-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-253"><a href="#cb41-253" aria-hidden="true" tabindex="-1"></a>Using a named list to give friendly names to directions in the 3x3 matrices:</span>
<span id="cb41-256"><a href="#cb41-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-257"><a href="#cb41-257" aria-hidden="true" tabindex="-1"></a>directions <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb41-258"><a href="#cb41-258" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>),</span>
<span id="cb41-259"><a href="#cb41-259" aria-hidden="true" tabindex="-1"></a>  <span class="st">"N"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb41-260"><a href="#cb41-260" aria-hidden="true" tabindex="-1"></a>  <span class="st">"E"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb41-261"><a href="#cb41-261" aria-hidden="true" tabindex="-1"></a>  <span class="st">"W"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb41-262"><a href="#cb41-262" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-263"><a href="#cb41-263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-264"><a href="#cb41-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-265"><a href="#cb41-265" aria-hidden="true" tabindex="-1"></a>Now let's use this function to calculate the distances surrounding our current location (<span class="in">`current_tile1`</span>).</span>
<span id="cb41-268"><a href="#cb41-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-269"><a href="#cb41-269" aria-hidden="true" tabindex="-1"></a>central_tile <span class="ot">&lt;-</span> surroundings[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb41-270"><a href="#cb41-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-271"><a href="#cb41-271" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i_dir <span class="cf">in</span> <span class="fu">seq_along</span>(directions)) {</span>
<span id="cb41-272"><a href="#cb41-272" aria-hidden="true" tabindex="-1"></a>  direction <span class="ot">&lt;-</span> <span class="fu">names</span>(directions)[i_dir]</span>
<span id="cb41-273"><a href="#cb41-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-274"><a href="#cb41-274" aria-hidden="true" tabindex="-1"></a>  surr_i <span class="ot">&lt;-</span> directions[[i_dir]][<span class="dv">1</span>]</span>
<span id="cb41-275"><a href="#cb41-275" aria-hidden="true" tabindex="-1"></a>  surr_j <span class="ot">&lt;-</span> directions[[i_dir]][<span class="dv">2</span>]</span>
<span id="cb41-276"><a href="#cb41-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-277"><a href="#cb41-277" aria-hidden="true" tabindex="-1"></a>  cur_surr_tile <span class="ot">&lt;-</span> surroundings[surr_i, surr_j]</span>
<span id="cb41-278"><a href="#cb41-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-279"><a href="#cb41-279" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(distances[surr_i, surr_j])) {</span>
<span id="cb41-280"><a href="#cb41-280" aria-hidden="true" tabindex="-1"></a>    <span class="co"># NA in distance means a comparation hasn't been done</span></span>
<span id="cb41-281"><a href="#cb41-281" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (direction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"E"</span>)) tile_pair <span class="ot">&lt;-</span> <span class="fu">c</span>(central_tile, cur_surr_tile)</span>
<span id="cb41-282"><a href="#cb41-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-283"><a href="#cb41-283" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (direction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"W"</span>)) tile_pair <span class="ot">&lt;-</span> <span class="fu">c</span>(cur_surr_tile, central_tile)</span>
<span id="cb41-284"><a href="#cb41-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-285"><a href="#cb41-285" aria-hidden="true" tabindex="-1"></a>    connected <span class="ot">&lt;-</span> <span class="fu">is_connected</span>(tile_pair, direction)</span>
<span id="cb41-286"><a href="#cb41-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-287"><a href="#cb41-287" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (connected) {</span>
<span id="cb41-288"><a href="#cb41-288" aria-hidden="true" tabindex="-1"></a>      distances[surr_i, surr_j] <span class="ot">&lt;-</span> distances[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb41-289"><a href="#cb41-289" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-290"><a href="#cb41-290" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-291"><a href="#cb41-291" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-292"><a href="#cb41-292" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb41-293"><a href="#cb41-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-294"><a href="#cb41-294" aria-hidden="true" tabindex="-1"></a>all_distances[(i<span class="dv">-1</span>)<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">1</span>), (j<span class="dv">-1</span>)<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> distances</span>
<span id="cb41-295"><a href="#cb41-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-296"><a href="#cb41-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-297"><a href="#cb41-297" aria-hidden="true" tabindex="-1"></a>So far, the code is working as expected.</span>
<span id="cb41-298"><a href="#cb41-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-299"><a href="#cb41-299" aria-hidden="true" tabindex="-1"></a>Now it's time to organise the code into functions. I need to start with a function that does the following:</span>
<span id="cb41-300"><a href="#cb41-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-301"><a href="#cb41-301" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Receives <span class="in">`sketch`</span>, <span class="in">`all_distances`</span> and a set of coordinates (the output of <span class="in">`which.max`</span>) as inputs.</span>
<span id="cb41-302"><a href="#cb41-302" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Explores the surroundings of those coordinates.</span>
<span id="cb41-303"><a href="#cb41-303" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Applies the previously described logic to calculate distance values for tiles connected to those coordinates.</span>
<span id="cb41-304"><a href="#cb41-304" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Return an updated version of the <span class="in">`all_distances`</span> with the values from the previous step.</span>
<span id="cb41-305"><a href="#cb41-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-306"><a href="#cb41-306" aria-hidden="true" tabindex="-1"></a>The set of coordinates will be assummed to be a matrix, as per the output of <span class="in">`which(all_distances == max(all_distances, na.rm = TRUE), arr.ind = TRUE)`</span>.</span>
<span id="cb41-307"><a href="#cb41-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-310"><a href="#cb41-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-311"><a href="#cb41-311" aria-hidden="true" tabindex="-1"></a>explore_surroundings <span class="ot">&lt;-</span></span>
<span id="cb41-312"><a href="#cb41-312" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(</span>
<span id="cb41-313"><a href="#cb41-313" aria-hidden="true" tabindex="-1"></a>    coordinates,</span>
<span id="cb41-314"><a href="#cb41-314" aria-hidden="true" tabindex="-1"></a>    <span class="at">this_sketch =</span> sketch,</span>
<span id="cb41-315"><a href="#cb41-315" aria-hidden="true" tabindex="-1"></a>    <span class="at">these_distances =</span> all_distances) {</span>
<span id="cb41-316"><a href="#cb41-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-317"><a href="#cb41-317" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i_coord <span class="cf">in</span> <span class="fu">seq_along</span>(coordinates[,<span class="st">"row"</span>])) {</span>
<span id="cb41-318"><a href="#cb41-318" aria-hidden="true" tabindex="-1"></a>        i <span class="ot">&lt;-</span> coordinates[i_coord, <span class="st">"row"</span>]</span>
<span id="cb41-319"><a href="#cb41-319" aria-hidden="true" tabindex="-1"></a>        j <span class="ot">&lt;-</span> coordinates[i_coord, <span class="st">"col"</span>]</span>
<span id="cb41-320"><a href="#cb41-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-321"><a href="#cb41-321" aria-hidden="true" tabindex="-1"></a>        surroundings <span class="ot">&lt;-</span> this_sketch[(i <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span>(i <span class="sc">+</span> <span class="dv">1</span>), (j <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span>(j <span class="sc">+</span> <span class="dv">1</span>)]</span>
<span id="cb41-322"><a href="#cb41-322" aria-hidden="true" tabindex="-1"></a>        distances <span class="ot">&lt;-</span> these_distances[(i <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span>(i <span class="sc">+</span> <span class="dv">1</span>), (j <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span>(j <span class="sc">+</span> <span class="dv">1</span>)]</span>
<span id="cb41-323"><a href="#cb41-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-324"><a href="#cb41-324" aria-hidden="true" tabindex="-1"></a>        central_tile <span class="ot">&lt;-</span> surroundings[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb41-325"><a href="#cb41-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-326"><a href="#cb41-326" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i_dir <span class="cf">in</span> <span class="fu">seq_along</span>(directions)) {</span>
<span id="cb41-327"><a href="#cb41-327" aria-hidden="true" tabindex="-1"></a>          direction <span class="ot">&lt;-</span> <span class="fu">names</span>(directions)[i_dir]</span>
<span id="cb41-328"><a href="#cb41-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-329"><a href="#cb41-329" aria-hidden="true" tabindex="-1"></a>          surr_i <span class="ot">&lt;-</span> directions[[i_dir]][<span class="dv">1</span>]</span>
<span id="cb41-330"><a href="#cb41-330" aria-hidden="true" tabindex="-1"></a>          surr_j <span class="ot">&lt;-</span> directions[[i_dir]][<span class="dv">2</span>]</span>
<span id="cb41-331"><a href="#cb41-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-332"><a href="#cb41-332" aria-hidden="true" tabindex="-1"></a>          cur_surr_tile <span class="ot">&lt;-</span> surroundings[surr_i, surr_j]</span>
<span id="cb41-333"><a href="#cb41-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-334"><a href="#cb41-334" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (<span class="fu">is.na</span>(distances[surr_i, surr_j])) {</span>
<span id="cb41-335"><a href="#cb41-335" aria-hidden="true" tabindex="-1"></a>            <span class="co"># NA in distance means a comparation hasn't been done</span></span>
<span id="cb41-336"><a href="#cb41-336" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (direction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"S"</span>, <span class="st">"E"</span>)) tile_pair <span class="ot">&lt;-</span> <span class="fu">c</span>(central_tile, cur_surr_tile)</span>
<span id="cb41-337"><a href="#cb41-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-338"><a href="#cb41-338" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (direction <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"W"</span>)) tile_pair <span class="ot">&lt;-</span> <span class="fu">c</span>(cur_surr_tile, central_tile)</span>
<span id="cb41-339"><a href="#cb41-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-340"><a href="#cb41-340" aria-hidden="true" tabindex="-1"></a>            connected <span class="ot">&lt;-</span> <span class="fu">is_connected</span>(tile_pair, direction)</span>
<span id="cb41-341"><a href="#cb41-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-342"><a href="#cb41-342" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (connected) {</span>
<span id="cb41-343"><a href="#cb41-343" aria-hidden="true" tabindex="-1"></a>              distances[surr_i, surr_j] <span class="ot">&lt;-</span> distances[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb41-344"><a href="#cb41-344" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb41-345"><a href="#cb41-345" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb41-346"><a href="#cb41-346" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb41-347"><a href="#cb41-347" aria-hidden="true" tabindex="-1"></a>        these_distances[(i <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span>(i <span class="sc">+</span> <span class="dv">1</span>), (j <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span>(j <span class="sc">+</span> <span class="dv">1</span>)] <span class="ot">&lt;-</span> distances</span>
<span id="cb41-348"><a href="#cb41-348" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb41-349"><a href="#cb41-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-350"><a href="#cb41-350" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(these_distances)</span>
<span id="cb41-351"><a href="#cb41-351" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-352"><a href="#cb41-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-353"><a href="#cb41-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-354"><a href="#cb41-354" aria-hidden="true" tabindex="-1"></a>Now, I should be able to navigate through the pipes by repeatedly executing the following code:</span>
<span id="cb41-357"><a href="#cb41-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-358"><a href="#cb41-358" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false </span></span>
<span id="cb41-359"><a href="#cb41-359" aria-hidden="true" tabindex="-1"></a><span class="co"># Example code: not meant to run</span></span>
<span id="cb41-360"><a href="#cb41-360" aria-hidden="true" tabindex="-1"></a>all_distances <span class="ot">&lt;-</span> <span class="fu">explore_surroundings</span>(further_away)</span>
<span id="cb41-361"><a href="#cb41-361" aria-hidden="true" tabindex="-1"></a>further_away <span class="ot">&lt;-</span> <span class="fu">which</span>(all_distances <span class="sc">==</span> <span class="fu">max</span>(all_distances, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-362"><a href="#cb41-362" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-363"><a href="#cb41-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-364"><a href="#cb41-364" aria-hidden="true" tabindex="-1"></a>I'm considering a <span class="in">`while`</span> loop for this, but I'm not quite sure what the stopping condition should be. Maybe it could stop when it's about to overwrite a cell that already has a distance value. That would mean we're going back to a cell we've already visited, suggesting the loop has come full circle.</span>
<span id="cb41-365"><a href="#cb41-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-366"><a href="#cb41-366" aria-hidden="true" tabindex="-1"></a>Let's try doing that. First, we declare the starting conditions:</span>
<span id="cb41-369"><a href="#cb41-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-370"><a href="#cb41-370" aria-hidden="true" tabindex="-1"></a>further_away <span class="ot">&lt;-</span> <span class="fu">which</span>(sketch <span class="sc">==</span> <span class="st">"S"</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-371"><a href="#cb41-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-372"><a href="#cb41-372" aria-hidden="true" tabindex="-1"></a>all_distances <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb41-373"><a href="#cb41-373" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="fu">dim</span>(sketch)[<span class="dv">1</span>],</span>
<span id="cb41-374"><a href="#cb41-374" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="fu">dim</span>(sketch)[<span class="dv">2</span>]</span>
<span id="cb41-375"><a href="#cb41-375" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-376"><a href="#cb41-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-377"><a href="#cb41-377" aria-hidden="true" tabindex="-1"></a>all_distances[further_away[<span class="dv">1</span>, <span class="st">"row"</span>], further_away[<span class="dv">1</span>, <span class="st">"col"</span>]] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb41-378"><a href="#cb41-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-379"><a href="#cb41-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-380"><a href="#cb41-380" aria-hidden="true" tabindex="-1"></a>Now onto the loop itself:</span>
<span id="cb41-383"><a href="#cb41-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-384"><a href="#cb41-384" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb41-385"><a href="#cb41-385" aria-hidden="true" tabindex="-1"></a>  new_distances <span class="ot">&lt;-</span> <span class="fu">explore_surroundings</span>(further_away)</span>
<span id="cb41-386"><a href="#cb41-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-387"><a href="#cb41-387" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Stopping condition</span></span>
<span id="cb41-388"><a href="#cb41-388" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(new_distances <span class="sc">&gt;</span> all_distances, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb41-389"><a href="#cb41-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-390"><a href="#cb41-390" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Another stopping condition: the amount of NAs is the same (no exploration)</span></span>
<span id="cb41-391"><a href="#cb41-391" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">sum</span>(<span class="fu">is.na</span>(new_distances)) <span class="sc">==</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(all_distances))) <span class="cf">break</span> </span>
<span id="cb41-392"><a href="#cb41-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-393"><a href="#cb41-393" aria-hidden="true" tabindex="-1"></a>  all_distances <span class="ot">&lt;-</span> new_distances</span>
<span id="cb41-394"><a href="#cb41-394" aria-hidden="true" tabindex="-1"></a>  further_away <span class="ot">&lt;-</span> <span class="fu">which</span>(all_distances <span class="sc">==</span> <span class="fu">max</span>(all_distances, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-395"><a href="#cb41-395" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-396"><a href="#cb41-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-397"><a href="#cb41-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-398"><a href="#cb41-398" aria-hidden="true" tabindex="-1"></a>Once the code stops, I just need to find the highest value in the <span class="in">`all_distances`</span> matrix.</span>
<span id="cb41-399"><a href="#cb41-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-402"><a href="#cb41-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-403"><a href="#cb41-403" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(all_distances, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-404"><a href="#cb41-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-405"><a href="#cb41-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-406"><a href="#cb41-406" aria-hidden="true" tabindex="-1"></a>It's correct! (I almost can't believe it, given how messy my code is 😅).</span>
<span id="cb41-407"><a href="#cb41-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-408"><a href="#cb41-408" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2</span></span>
<span id="cb41-409"><a href="#cb41-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-410"><a href="#cb41-410" aria-hidden="true" tabindex="-1"></a>Now we have to calculate how many tiles are contained *within* the loop. The definition of being within the loop is quite specific. For example, in the sketch below, the tiles marked with `0` are technically *outside the loop*.</span>
<span id="cb41-411"><a href="#cb41-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-412"><a href="#cb41-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-413"><a href="#cb41-413" aria-hidden="true" tabindex="-1"></a><span class="in">..........</span></span>
<span id="cb41-414"><a href="#cb41-414" aria-hidden="true" tabindex="-1"></a><span class="in">.S------7.</span></span>
<span id="cb41-415"><a href="#cb41-415" aria-hidden="true" tabindex="-1"></a><span class="in">.|F----7|.</span></span>
<span id="cb41-416"><a href="#cb41-416" aria-hidden="true" tabindex="-1"></a><span class="in">.||OOOO||.</span></span>
<span id="cb41-417"><a href="#cb41-417" aria-hidden="true" tabindex="-1"></a><span class="in">.||OOOO||.</span></span>
<span id="cb41-418"><a href="#cb41-418" aria-hidden="true" tabindex="-1"></a><span class="in">.|L-7F-J|.</span></span>
<span id="cb41-419"><a href="#cb41-419" aria-hidden="true" tabindex="-1"></a><span class="in">.|II||II|.</span></span>
<span id="cb41-420"><a href="#cb41-420" aria-hidden="true" tabindex="-1"></a><span class="in">.L--JL--J.</span></span>
<span id="cb41-421"><a href="#cb41-421" aria-hidden="true" tabindex="-1"></a><span class="in">..........</span></span>
<span id="cb41-422"><a href="#cb41-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-423"><a href="#cb41-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-424"><a href="#cb41-424" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Any tile that isn't part of the main loop can count as being enclosed by the loop.</span></span>
<span id="cb41-425"><a href="#cb41-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-426"><a href="#cb41-426" aria-hidden="true" tabindex="-1"></a>The task is to find how many tiles are enclosed by the loop.</span>
<span id="cb41-427"><a href="#cb41-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-428"><a href="#cb41-428" aria-hidden="true" tabindex="-1"></a>Before trying to solve this, I want to visualize the values in the <span class="in">`all_distances`</span> matrix. This will help me get a better idea of the loop's size and shape.</span>
<span id="cb41-429"><a href="#cb41-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-432"><a href="#cb41-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-433"><a href="#cb41-433" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb41-434"><a href="#cb41-434" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plot.matrix)</span>
<span id="cb41-435"><a href="#cb41-435" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb41-436"><a href="#cb41-436" aria-hidden="true" tabindex="-1"></a>brk <span class="ot">&lt;-</span> <span class="dv">6000</span></span>
<span id="cb41-437"><a href="#cb41-437" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>))</span>
<span id="cb41-438"><a href="#cb41-438" aria-hidden="true" tabindex="-1"></a><span class="fu">svg</span>(<span class="st">"all_distances.svg"</span>, <span class="at">height=</span><span class="dv">80</span>, <span class="at">width=</span><span class="dv">80</span>)</span>
<span id="cb41-439"><a href="#cb41-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-440"><a href="#cb41-440" aria-hidden="true" tabindex="-1"></a><span class="co"># Code of the plot</span></span>
<span id="cb41-441"><a href="#cb41-441" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> <span class="fu">plot</span>(</span>
<span id="cb41-442"><a href="#cb41-442" aria-hidden="true" tabindex="-1"></a>  all_distances,</span>
<span id="cb41-443"><a href="#cb41-443" aria-hidden="true" tabindex="-1"></a>  <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb41-444"><a href="#cb41-444" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks=</span>brk,</span>
<span id="cb41-445"><a href="#cb41-445" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.col=</span><span class="st">"grey"</span>,</span>
<span id="cb41-446"><a href="#cb41-446" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.cell=</span><span class="cn">FALSE</span>,</span>
<span id="cb41-447"><a href="#cb41-447" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">magma</span>(brk), </span>
<span id="cb41-448"><a href="#cb41-448" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits=</span><span class="dv">1</span>,</span>
<span id="cb41-449"><a href="#cb41-449" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.cell=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.5</span>),</span>
<span id="cb41-450"><a href="#cb41-450" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt.cell=</span><span class="st">"%.0f"</span>,</span>
<span id="cb41-451"><a href="#cb41-451" aria-hidden="true" tabindex="-1"></a>  <span class="at">key=</span><span class="cn">NULL</span>,</span>
<span id="cb41-452"><a href="#cb41-452" aria-hidden="true" tabindex="-1"></a>  <span class="at">polygon.key=</span><span class="cn">NULL</span>,</span>
<span id="cb41-453"><a href="#cb41-453" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.col=</span><span class="cn">NULL</span>,</span>
<span id="cb41-454"><a href="#cb41-454" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.row=</span><span class="cn">NULL</span>,</span>
<span id="cb41-455"><a href="#cb41-455" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="cn">NA</span>, <span class="at">ylab=</span><span class="cn">NA</span>)</span>
<span id="cb41-456"><a href="#cb41-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-457"><a href="#cb41-457" aria-hidden="true" tabindex="-1"></a><span class="co"># Close the graphics device</span></span>
<span id="cb41-458"><a href="#cb41-458" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb41-459"><a href="#cb41-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-460"><a href="#cb41-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-461"><a href="#cb41-461" aria-hidden="true" tabindex="-1"></a>The output of the code above is a giant SVG image that depicts the full <span class="in">`all_distances`</span> matrix, highlighting the tiles that are part of the loop (they're colour-coded based on their distance to the starting tile and they also display the distance value as text on top of them).</span>
<span id="cb41-462"><a href="#cb41-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-463"><a href="#cb41-463" aria-hidden="true" tabindex="-1"></a>The plot with the text is too big to show it on this page (here is the <span class="co">[</span><span class="ot">full-size version of the plot</span><span class="co">](all_distances.svg)</span>), so I'll display just a section of it below. </span>
<span id="cb41-466"><a href="#cb41-466" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-467"><a href="#cb41-467" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> position_s[<span class="dv">1</span>]</span>
<span id="cb41-468"><a href="#cb41-468" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> position_s[<span class="dv">2</span>]</span>
<span id="cb41-469"><a href="#cb41-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-470"><a href="#cb41-470" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb41-471"><a href="#cb41-471" aria-hidden="true" tabindex="-1"></a>  all_distances[(i<span class="dv">-10</span>)<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">10</span>), (j<span class="dv">-10</span>)<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">10</span>)],</span>
<span id="cb41-472"><a href="#cb41-472" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">"Tiles in the loop (and their distances to origin)"</span>,</span>
<span id="cb41-473"><a href="#cb41-473" aria-hidden="true" tabindex="-1"></a>  <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb41-474"><a href="#cb41-474" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks=</span>brk,</span>
<span id="cb41-475"><a href="#cb41-475" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.col=</span><span class="st">"grey"</span>,</span>
<span id="cb41-476"><a href="#cb41-476" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.cell=</span><span class="cn">FALSE</span>,</span>
<span id="cb41-477"><a href="#cb41-477" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">magma</span>(brk), </span>
<span id="cb41-478"><a href="#cb41-478" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits=</span><span class="dv">1</span>,</span>
<span id="cb41-479"><a href="#cb41-479" aria-hidden="true" tabindex="-1"></a>  <span class="at">text.cell=</span><span class="fu">list</span>(<span class="at">cex=</span><span class="fl">0.5</span>),</span>
<span id="cb41-480"><a href="#cb41-480" aria-hidden="true" tabindex="-1"></a>  <span class="at">fmt.cell=</span><span class="st">"%.0f"</span>,</span>
<span id="cb41-481"><a href="#cb41-481" aria-hidden="true" tabindex="-1"></a>  <span class="at">key=</span><span class="cn">NULL</span>,</span>
<span id="cb41-482"><a href="#cb41-482" aria-hidden="true" tabindex="-1"></a>  <span class="at">polygon.key=</span><span class="cn">NULL</span>,</span>
<span id="cb41-483"><a href="#cb41-483" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.col=</span><span class="cn">NULL</span>,</span>
<span id="cb41-484"><a href="#cb41-484" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.row=</span><span class="cn">NULL</span>,</span>
<span id="cb41-485"><a href="#cb41-485" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="cn">NA</span>, <span class="at">ylab=</span><span class="cn">NA</span>,</span>
<span id="cb41-486"><a href="#cb41-486" aria-hidden="true" tabindex="-1"></a>  <span class="at">asp=</span><span class="dv">1</span>)</span>
<span id="cb41-487"><a href="#cb41-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-488"><a href="#cb41-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-489"><a href="#cb41-489" aria-hidden="true" tabindex="-1"></a>And here is a "miniature version" without the text (darker colours represent tiles closer to the origin and white represents tiles that are not part of the loop).</span>
<span id="cb41-492"><a href="#cb41-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-493"><a href="#cb41-493" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb41-494"><a href="#cb41-494" aria-hidden="true" tabindex="-1"></a>  all_distances,</span>
<span id="cb41-495"><a href="#cb41-495" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="cn">NULL</span>,</span>
<span id="cb41-496"><a href="#cb41-496" aria-hidden="true" tabindex="-1"></a>  <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb41-497"><a href="#cb41-497" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks=</span>brk,</span>
<span id="cb41-498"><a href="#cb41-498" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.col=</span><span class="st">"grey"</span>,</span>
<span id="cb41-499"><a href="#cb41-499" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.cell=</span><span class="cn">FALSE</span>,</span>
<span id="cb41-500"><a href="#cb41-500" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">magma</span>(brk), </span>
<span id="cb41-501"><a href="#cb41-501" aria-hidden="true" tabindex="-1"></a>  <span class="at">key=</span><span class="cn">NULL</span>,</span>
<span id="cb41-502"><a href="#cb41-502" aria-hidden="true" tabindex="-1"></a>  <span class="at">polygon.key=</span><span class="cn">NULL</span>,</span>
<span id="cb41-503"><a href="#cb41-503" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.col=</span><span class="cn">NULL</span>,</span>
<span id="cb41-504"><a href="#cb41-504" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.row=</span><span class="cn">NULL</span>,</span>
<span id="cb41-505"><a href="#cb41-505" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="cn">NA</span>, <span class="at">ylab=</span><span class="cn">NA</span>,</span>
<span id="cb41-506"><a href="#cb41-506" aria-hidden="true" tabindex="-1"></a>  <span class="at">asp=</span><span class="dv">1</span>)</span>
<span id="cb41-507"><a href="#cb41-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-508"><a href="#cb41-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-509"><a href="#cb41-509" aria-hidden="true" tabindex="-1"></a>Based on the plot, we can see that the loop is really big and has a complex shape, including many twists and turns.</span>
<span id="cb41-510"><a href="#cb41-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-511"><a href="#cb41-511" aria-hidden="true" tabindex="-1"></a>I'm also curious about how many 'arms' or paths branch off from the loop. Are there any that lead to dead-ends and don't reconnect with the main loop? (In that case, there would be distance values I would have to discard before identifying the tiles enclosed by the loop).</span>
<span id="cb41-512"><a href="#cb41-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-515"><a href="#cb41-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-516"><a href="#cb41-516" aria-hidden="true" tabindex="-1"></a>distances_values <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">max</span>(all_distances, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-517"><a href="#cb41-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-518"><a href="#cb41-518" aria-hidden="true" tabindex="-1"></a>n_tiles_distance <span class="ot">&lt;-</span> <span class="cf">function</span>(distance) {</span>
<span id="cb41-519"><a href="#cb41-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(all_distances <span class="sc">==</span> distance, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb41-520"><a href="#cb41-520" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-521"><a href="#cb41-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-522"><a href="#cb41-522" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb41-523"><a href="#cb41-523" aria-hidden="true" tabindex="-1"></a>  <span class="at">distances =</span> distances_values,</span>
<span id="cb41-524"><a href="#cb41-524" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_paths =</span> <span class="fu">map_dbl</span>(distances, n_tiles_distance)</span>
<span id="cb41-525"><a href="#cb41-525" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb41-526"><a href="#cb41-526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(n_paths)</span>
<span id="cb41-527"><a href="#cb41-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-528"><a href="#cb41-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-529"><a href="#cb41-529" aria-hidden="true" tabindex="-1"></a>There are always only two paths branching off the starting tile, ensuring there are no 'dead-ends' in the loop.</span>
<span id="cb41-530"><a href="#cb41-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-531"><a href="#cb41-531" aria-hidden="true" tabindex="-1"></a>Next steps:</span>
<span id="cb41-532"><a href="#cb41-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-533"><a href="#cb41-533" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Traverse the loop in a counter-clockwise direction, inspecting the tiles to the left of the path. Consider tiles with <span class="in">`NA`</span> as distance value as "enclosed" by the loop.</span>
<span id="cb41-534"><a href="#cb41-534" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>After identifying these inner loop cells (and verifying via visual inspection that they actually are within the loop), initiate a 'contagion' process. This means marking contiguous non-loop tiles as "enclosed by the loop".</span>
<span id="cb41-535"><a href="#cb41-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-536"><a href="#cb41-536" aria-hidden="true" tabindex="-1"></a>Implementing my idea for the "base case" (the starting tile <span class="in">`S`</span>):</span>
<span id="cb41-539"><a href="#cb41-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-540"><a href="#cb41-540" aria-hidden="true" tabindex="-1"></a>starting_position <span class="ot">&lt;-</span> <span class="fu">which</span>(all_distances <span class="sc">==</span> <span class="dv">0</span>, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-541"><a href="#cb41-541" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> starting_position[<span class="dv">1</span>, <span class="st">"row"</span>]</span>
<span id="cb41-542"><a href="#cb41-542" aria-hidden="true" tabindex="-1"></a>j <span class="ot">&lt;-</span> starting_position[<span class="dv">1</span>, <span class="st">"col"</span>]</span>
<span id="cb41-543"><a href="#cb41-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-544"><a href="#cb41-544" aria-hidden="true" tabindex="-1"></a>directions <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb41-545"><a href="#cb41-545" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>),</span>
<span id="cb41-546"><a href="#cb41-546" aria-hidden="true" tabindex="-1"></a>  <span class="st">"N"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb41-547"><a href="#cb41-547" aria-hidden="true" tabindex="-1"></a>  <span class="st">"W"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb41-548"><a href="#cb41-548" aria-hidden="true" tabindex="-1"></a>  <span class="st">"E"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb41-549"><a href="#cb41-549" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-550"><a href="#cb41-550" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-551"><a href="#cb41-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-552"><a href="#cb41-552" aria-hidden="true" tabindex="-1"></a>The coordinates for 'the cell to the left' and 'the cell to the right' will vary depending on the direction. E.g. if we go South from the centre tile (2,2 to 3,2), the coordinates of the "cell to the right" are going to be 3,1.</span>
<span id="cb41-555"><a href="#cb41-555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-556"><a href="#cb41-556" aria-hidden="true" tabindex="-1"></a>to_the_right <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb41-557"><a href="#cb41-557" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb41-558"><a href="#cb41-558" aria-hidden="true" tabindex="-1"></a>  <span class="st">"N"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb41-559"><a href="#cb41-559" aria-hidden="true" tabindex="-1"></a>  <span class="st">"E"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb41-560"><a href="#cb41-560" aria-hidden="true" tabindex="-1"></a>  <span class="st">"W"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb41-561"><a href="#cb41-561" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-562"><a href="#cb41-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-563"><a href="#cb41-563" aria-hidden="true" tabindex="-1"></a>to_the_left <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb41-564"><a href="#cb41-564" aria-hidden="true" tabindex="-1"></a>  <span class="st">"S"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb41-565"><a href="#cb41-565" aria-hidden="true" tabindex="-1"></a>  <span class="st">"N"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb41-566"><a href="#cb41-566" aria-hidden="true" tabindex="-1"></a>  <span class="st">"E"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb41-567"><a href="#cb41-567" aria-hidden="true" tabindex="-1"></a>  <span class="st">"W"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb41-568"><a href="#cb41-568" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-569"><a href="#cb41-569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-570"><a href="#cb41-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-571"><a href="#cb41-571" aria-hidden="true" tabindex="-1"></a>I'll use the value -1 in the distances matrix to mark the tiles that are enclosed by the loop.</span>
<span id="cb41-574"><a href="#cb41-574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-575"><a href="#cb41-575" aria-hidden="true" tabindex="-1"></a>new_i <span class="ot">&lt;-</span> i</span>
<span id="cb41-576"><a href="#cb41-576" aria-hidden="true" tabindex="-1"></a>new_j <span class="ot">&lt;-</span> j</span>
<span id="cb41-577"><a href="#cb41-577" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb41-578"><a href="#cb41-578" aria-hidden="true" tabindex="-1"></a>  distances <span class="ot">&lt;-</span> all_distances[(new_i<span class="dv">-1</span>)<span class="sc">:</span>(new_i<span class="sc">+</span><span class="dv">1</span>), (new_j<span class="dv">-1</span>)<span class="sc">:</span>(new_j<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb41-579"><a href="#cb41-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-580"><a href="#cb41-580" aria-hidden="true" tabindex="-1"></a>  <span class="co"># I'll use the `directions` vector which was declared before to check the cardinal coordinates</span></span>
<span id="cb41-581"><a href="#cb41-581" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Given the order of the list `directions`, this loop will go East first</span></span>
<span id="cb41-582"><a href="#cb41-582" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i_dir <span class="cf">in</span> <span class="fu">seq_along</span>(directions)) {</span>
<span id="cb41-583"><a href="#cb41-583" aria-hidden="true" tabindex="-1"></a>    direction <span class="ot">&lt;-</span> <span class="fu">names</span>(directions)[i_dir]</span>
<span id="cb41-584"><a href="#cb41-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-585"><a href="#cb41-585" aria-hidden="true" tabindex="-1"></a>    surr_i <span class="ot">&lt;-</span> directions[[i_dir]][<span class="dv">1</span>]</span>
<span id="cb41-586"><a href="#cb41-586" aria-hidden="true" tabindex="-1"></a>    surr_j <span class="ot">&lt;-</span> directions[[i_dir]][<span class="dv">2</span>]</span>
<span id="cb41-587"><a href="#cb41-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-588"><a href="#cb41-588" aria-hidden="true" tabindex="-1"></a>    surr_dist_val <span class="ot">&lt;-</span> <span class="fu">replace_na</span>(distances[surr_i, surr_j], <span class="dv">0</span>)</span>
<span id="cb41-589"><a href="#cb41-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-590"><a href="#cb41-590" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Go in the direction of the cell that increments distance by 1</span></span>
<span id="cb41-591"><a href="#cb41-591" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (surr_dist_val <span class="sc">-</span> distances[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb41-592"><a href="#cb41-592" aria-hidden="true" tabindex="-1"></a>      <span class="co">#  mark the tile to the left as "inside"</span></span>
<span id="cb41-593"><a href="#cb41-593" aria-hidden="true" tabindex="-1"></a>      i_left <span class="ot">&lt;-</span> to_the_left[[direction]][<span class="dv">1</span>]</span>
<span id="cb41-594"><a href="#cb41-594" aria-hidden="true" tabindex="-1"></a>      j_left <span class="ot">&lt;-</span> to_the_left[[direction]][<span class="dv">1</span>]</span>
<span id="cb41-595"><a href="#cb41-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-596"><a href="#cb41-596" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">is.na</span>(distances[i_left, j_left])) {</span>
<span id="cb41-597"><a href="#cb41-597" aria-hidden="true" tabindex="-1"></a>        distances[i_left, j_left] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb41-598"><a href="#cb41-598" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb41-599"><a href="#cb41-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-600"><a href="#cb41-600" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Updating i and j to reflect that we moved</span></span>
<span id="cb41-601"><a href="#cb41-601" aria-hidden="true" tabindex="-1"></a>      new_i <span class="ot">&lt;-</span> i <span class="sc">+</span> surr_i <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb41-602"><a href="#cb41-602" aria-hidden="true" tabindex="-1"></a>      new_j <span class="ot">&lt;-</span> j <span class="sc">+</span> surr_j <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb41-603"><a href="#cb41-603" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb41-604"><a href="#cb41-604" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb41-605"><a href="#cb41-605" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-606"><a href="#cb41-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-607"><a href="#cb41-607" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stopping condition: </span></span>
<span id="cb41-608"><a href="#cb41-608" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (distances[<span class="dv">2</span>, <span class="dv">2</span>] <span class="sc">==</span> all_distances[new_i, new_j]) <span class="cf">break</span></span>
<span id="cb41-609"><a href="#cb41-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-610"><a href="#cb41-610" aria-hidden="true" tabindex="-1"></a>  all_distances[(i<span class="dv">-1</span>)<span class="sc">:</span>(i<span class="sc">+</span><span class="dv">1</span>), (j<span class="dv">-1</span>)<span class="sc">:</span>(j<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> distances</span>
<span id="cb41-611"><a href="#cb41-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-612"><a href="#cb41-612" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> new_i</span>
<span id="cb41-613"><a href="#cb41-613" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> new_j</span>
<span id="cb41-614"><a href="#cb41-614" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-615"><a href="#cb41-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-616"><a href="#cb41-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-617"><a href="#cb41-617" aria-hidden="true" tabindex="-1"></a>Counting the tiles that have been marked as inside the loop until now.</span>
<span id="cb41-620"><a href="#cb41-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-621"><a href="#cb41-621" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(all_distances <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb41-622"><a href="#cb41-622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb41-623"><a href="#cb41-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-624"><a href="#cb41-624" aria-hidden="true" tabindex="-1"></a>Visual inspection:</span>
<span id="cb41-627"><a href="#cb41-627" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb41-628"><a href="#cb41-628" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb41-629"><a href="#cb41-629" aria-hidden="true" tabindex="-1"></a>  all_distances,</span>
<span id="cb41-630"><a href="#cb41-630" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">'Tiles inside the loop (before the contagion process)'</span>,</span>
<span id="cb41-631"><a href="#cb41-631" aria-hidden="true" tabindex="-1"></a>  <span class="at">sub=</span><span class="st">"White = NA / Grey = Part of the loop / Black = enclosed by the loop"</span>,</span>
<span id="cb41-632"><a href="#cb41-632" aria-hidden="true" tabindex="-1"></a>  <span class="at">border=</span><span class="cn">NA</span>,</span>
<span id="cb41-633"><a href="#cb41-633" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb41-634"><a href="#cb41-634" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.col=</span><span class="st">"grey"</span>,</span>
<span id="cb41-635"><a href="#cb41-635" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.cell=</span><span class="cn">FALSE</span>,</span>
<span id="cb41-636"><a href="#cb41-636" aria-hidden="true" tabindex="-1"></a>  <span class="at">col=</span><span class="fu">magma</span>(<span class="dv">4</span>), </span>
<span id="cb41-637"><a href="#cb41-637" aria-hidden="true" tabindex="-1"></a>  <span class="at">key=</span><span class="cn">NULL</span>,</span>
<span id="cb41-638"><a href="#cb41-638" aria-hidden="true" tabindex="-1"></a>  <span class="at">polygon.key=</span><span class="cn">NULL</span>,</span>
<span id="cb41-639"><a href="#cb41-639" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.col=</span><span class="cn">NULL</span>,</span>
<span id="cb41-640"><a href="#cb41-640" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.row=</span><span class="cn">NULL</span>,</span>
<span id="cb41-641"><a href="#cb41-641" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="cn">NA</span>, <span class="at">ylab=</span><span class="cn">NA</span>,</span>
<span id="cb41-642"><a href="#cb41-642" aria-hidden="true" tabindex="-1"></a>  <span class="at">asp=</span><span class="dv">1</span>)</span>
<span id="cb41-643"><a href="#cb41-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span> </span>
<span id="cb41-644"><a href="#cb41-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-645"><a href="#cb41-645" aria-hidden="true" tabindex="-1"></a>After looking carefully at <span class="co">[</span><span class="ot">the full-size visualisation</span><span class="co">](all_distances_part2.svg)</span>, it seems there are two issues:</span>
<span id="cb41-646"><a href="#cb41-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-647"><a href="#cb41-647" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>I'm not correctly handling the case then the loop takes a turn.</span>
<span id="cb41-648"><a href="#cb41-648" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Only one of the loop's 'arms' is being traversed, but there are two.</span>
<span id="cb41-649"><a href="#cb41-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-650"><a href="#cb41-650" aria-hidden="true" tabindex="-1"></a>Unfortunately, the time I've spent on this problem has exceeded my "time budget" and I'm not even sure that the algorithm I'm implementing will lead to the correct solution, so I'm deciding to stop here.</span>
<span id="cb41-651"><a href="#cb41-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-652"><a href="#cb41-652" aria-hidden="true" tabindex="-1"></a><span class="al">![](Thats_all_folks.png "That's all folks!")</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>